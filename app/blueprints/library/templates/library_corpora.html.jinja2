{% extends "library.html.jinja2" %}

{% block library_content %}
<h2 class="h5">Your files</h2>

{% if user_files|length > 0 %}
<table class="table table-striped">
    <thead>
        <tr>
            <th>File name</th>
            <th>Language</th>
            <th>Lines</th>
            <th>Words</th>
            <th>Chars</th>
            <th>Date</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        {% for user_file in user_files %}
        <tr>
            <td>{{ user_file.file.name }}</td>
            <td>{{ user_file.file.language.name }}</td>
            <td>{{ user_file.file.lines }}</td>
            <td>{{ user_file.file.words }}</td>
            <td>{{ user_file.file.chars }}</td>
            <td>{{ user_file.file.uploaded }}</td>
            <td>
                <div class="dropdown">
                    <button class="btn btn-link btn-sm" id="dropdownMenuButton" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <i class="fas fa-ellipsis-v"></i> <span class="sr-only">Options</span>
                    </button>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuButton">
                        {% if user_file.file.uploader_id == get_user().id %}
                            {% if user_file.file.public %}
                            <a href="{{ url_for('library.library_share_toggle', id = user_file.file.id) }}" class="dropdown-item">
                                <i class="fas fa-lock"></i> Stop sharing
                            </a>
                            {% else %}
                            <a href="{{ url_for('library.library_share_toggle', id = user_file.file.id) }}" class="dropdown-item">
                                <i class="fas fa-lock-open"></i> Share
                            </a>
                            {% endif %}

                            <a href="{{ url_for('library.library_delete', id = user_file.file.id, type = page_name) }}" class="dropdown-item text-danger">
                                <i class="fas fa-trash"></i> Delete
                            </a>
                        {% else %}
                            <a href="{{ url_for('library.library_ungrab', id = user_file.file.id, type = page_name) }}" class="dropdown-item text-danger">
                                <i class="fas fa-times"></i> Remove
                            </a>
                        {% endif %}
                    </div>
                </div>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<div class="jumbotron p-3 text-center">
    <p class="h6 m-0">
        Nothing yet! <a href="{{ url_for('data.data_index') }}">Upload a corpus now</a>
    </p>
</div>
{% endif %}

<h2 class="h5">Public files</h2>
<table class="table table-striped">
    <thead>
        <tr>
            <th>File name</th>
            <th>Language</th>
            <th>Lines</th>
            <th>Words</th>
            <th>Date</th>
            <th>Uploader</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        {% for file in public_files %}
        <tr>
            <td>{{ file.name }}</td>
            <td>{{ file.language.name }}</td>
            <td>{{ file.lines }}</td>
            <td>{{ file.words }}</td>
            <td>{{ file.uploaded }}</td>
            <td>{{ file.uploader.username }}</td>
            <td>
                <a href="{{ url_for('library.library_grab', id = file.id, type = page_name) }}" class="btn btn-sm btn-outline-primary">Grab</a>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
</div>
{% endblock %}